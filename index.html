<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>user@home:~</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap');

        :root {
            --bg-color: #0d1117;
            --text-color: #58a6ff;
            --prompt-color: #3fb950;
            --error-color: #ff7b72;
            --art-color: #d2a8ff; /* Purple for ASCII art */
            --font-stack: 'Fira Code', 'Courier New', monospace;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-stack);
            margin: 0;
            padding: 20px;
            font-size: 16px;
            overflow-x: hidden; /* Prevent horizontal scroll */
        }

        #terminal {
            max-width: 800px;
            margin: 0 auto;
        }

        /* ASCII Art Styling */
        #ascii-art {
            color: var(--art-color);
            font-weight: bold;
            font-size: 12px; /* Smaller font for art to fit mobile */
            white-space: pre; /* Crucial: Preserves ASCII spacing */
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .output-line {
            margin-bottom: 5px;
            white-space: pre-wrap;
            line-height: 1.4;
        }

        .command-line {
            display: flex;
            align-items: center;
            flex-wrap: wrap; /* Allows wrapping on small screens */
        }

        .prompt {
            color: var(--prompt-color);
            margin-right: 10px;
            font-weight: bold;
            flex-shrink: 0;
        }

        /* The container for what user types */
        .input-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        /* The real input is hidden but keeps focus */
        #hidden-input {
            position: absolute;
            opacity: 0;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: default;
        }

        /* The visible text mirroring the input */
        #typer {
            outline: none;
            border: none;
            white-space: pre;
        }

        /* The Block Cursor */
        .cursor {
            display: inline-block;
            width: 10px;
            height: 1.2em;
            background-color: var(--text-color);
            animation: blink 1s step-end infinite;
            vertical-align: middle;
            margin-left: 1px;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }

        a { color: inherit; text-decoration: underline; }
        a:hover { background-color: var(--text-color); color: var(--bg-color); text-decoration: none; }
    </style>
</head>
<body>

    <div id="terminal">
        <div id="ascii-art"></div>
        <div id="output"></div>
        
        <div class="command-line">
            <span class="prompt">visitor@portfolio:~$</span>
            <div class="input-container">
                <span id="typer"></span><span class="cursor">&nbsp;</span>
                <input type="text" id="hidden-input" autocomplete="off" autofocus>
            </div>
        </div>
    </div>

    <script>
        const outputDiv = document.getElementById('output');
        const asciiDiv = document.getElementById('ascii-art');
        const hiddenInput = document.getElementById('hidden-input');
        const typerSpan = document.getElementById('typer');
        
        // Define commands
        const commands = {
            help: "Available commands: <br> - <strong>about</strong>: Who am I?<br> - <strong>projects</strong>: View my work<br> - <strong>socials</strong>: Contact info<br> - <strong>clear</strong>: Clean the terminal",
            about: "I am a developer/designer based in [Location]. I love building clean, minimal web experiences.",
            projects: "1. <strong>CLI-Portfolio</strong>: This website.<br>2. <strong>Project Alpha</strong>: A cool React app.<br>3. <strong>Project Beta</strong>: Python automation scripts.",
            socials: "GitHub: <a href='https://github.com' target='_blank'>@username</a><br>Twitter: <a href='https://twitter.com' target='_blank'>@username</a><br>Email: hello@example.com",
            clear: "clear"
        };

        // ASCII Art Header
        const asciiHeader = `
██╗  ██╗██╗    ████████╗██╗  ██╗███████╗██████╗ ███████╗██╗
██║  ██║██║    ╚══██╔══╝██║  ██║██╔════╝██╔══██╗██╔════╝██║
███████║██║       ██║   ███████║█████╗  ██████╔╝█████╗  ██║
██╔══██║██║       ██║   ██╔══██║██╔══╝  ██╔══██╗██╔══╝  ╚═╝
██║  ██║██║       ██║   ██║  ██║███████╗██║  ██║███████╗██╗
╚═╝  ╚═╝╚═╝       ╚═╝   ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚══════╝╚═╝`;

        // Initial welcome lines
        const welcomeMessage = [
            "Initializing secure connection...",
            "Loading system kernels...",
            "Welcome to user-server v1.0",
            "Type 'help' for a list of commands."
        ];

        let lineIndex = 0;

        // Typewriter effect
        function typeWriter(text, targetElement, speed, callback) {
            let i = 0;
            function type() {
                if (i < text.length) {
                    // Check if we are appending to innerHTML or textContent
                    if (targetElement.tagName === 'DIV') {
                        targetElement.innerHTML += text.charAt(i);
                    } else {
                        targetElement.textContent += text.charAt(i);
                    }
                    i++;
                    setTimeout(type, speed);
                } else {
                    if (callback) callback();
                }
            }
            type();
        }

        // Handle the ASCII art separately (instant load or fast type)
        function loadAscii() {
            asciiDiv.textContent = asciiHeader;
            runStartup(welcomeMessage);
        }

        function runStartup(lines) {
            if (lineIndex < lines.length) {
                const p = document.createElement('div');
                p.className = 'output-line';
                outputDiv.appendChild(p);
                typeWriter(lines[lineIndex], p, 20, () => {
                    lineIndex++;
                    runStartup(lines);
                });
            }
        }

        // --- THE BUG FIX: Sync hidden input to visible span ---
        hiddenInput.addEventListener('input', function() {
            typerSpan.textContent = this.value;
            window.scrollTo(0, document.body.scrollHeight);
        });

        // Handle Enter Key
        hiddenInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const command = this.value.trim().toLowerCase();
                
                // Add command to history
                outputDiv.innerHTML += `<div class="output-line"><span class="prompt">visitor@portfolio:~$</span> ${this.value}</div>`;
                
                if (commands[command]) {
                    if (command === 'clear') {
                        outputDiv.innerHTML = '';
                    } else {
                        outputDiv.innerHTML += `<div class="output-line">${commands[command]}</div>`;
                    }
                } else if (command !== "") {
                    outputDiv.innerHTML += `<div class="output-line" style="color:var(--error-color)">Command not found: ${command}. Type 'help'.</div>`;
                }

                this.value = '';
                typerSpan.textContent = ''; // Clear the visible span
                window.scrollTo(0, document.body.scrollHeight);
            }
        });

        // Focus logic: always focus hidden input when clicking anywhere
        document.addEventListener('click', () => {
            hiddenInput.focus();
        });

        // Start
        loadAscii();
    </script>
</body>
</html>